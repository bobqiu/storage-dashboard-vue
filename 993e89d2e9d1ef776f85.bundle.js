(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-307f847a"],{"0c54":function(e,t,n){"use strict";var i=n("6288"),r=n.n(i);r.a},"1aa1b":function(e,t,n){},"3c9b":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bsc-file",on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;""!==e.searchValue&&e.searchFile(e.searchValue)}}},[n("div",{staticClass:"layout-bsc-toolbar"},[n("a",{staticClass:"btn-back",on:{click:function(t){e.back()}}},[n("Icon",{attrs:{type:"chevron-left"}})],1),n("bsc-breadcrumb",[n("bsc-breadcrumb-item",{attrs:{href:e.bucketPath}},[e._v(e._s(e.$t("STORAGE.TITLE")))]),n("bsc-breadcrumb-item",{attrs:{href:e.getUrl("noprefix")}},[e._v(e._s(e.bucket))]),e._l(e.breadcrumb,function(t){return n("bsc-breadcrumb-item",{key:t.text,attrs:{href:e.getUrl(t.prefix)}},[e._v(e._s(t.text))])})],2)],1),n("Row",{staticClass:"toolbar-nav"},[n("Col",{attrs:{span:"10"}},[n("div",[n("Button",{directives:[{name:"show",rawName:"v-show",value:e.canUpload,expression:"canUpload"}],attrs:{type:"primary"},on:{click:e.openUploadModal}},[e._v(e._s(e.$t("STORAGE.UPLOAD_FILE")))]),n("Button",{directives:[{name:"show",rawName:"v-show",value:e.canUpload,expression:"canUpload"}],attrs:{type:"primary"},on:{click:function(t){e.createFolderModal=!0}}},[e._v(e._s(e.$t("STORAGE.CREATE_FOLDER")))]),n("Tooltip",{attrs:{content:"功能维护，暂停使用",placement:"bottom"}},[n("Button",{attrs:{type:"primary",disabled:""}},[e._v(e._s(e.$t("STORAGE.DOWNLOAD_FILES")))])],1),n("Button",{attrs:{disabled:!e.selectedFileList.length>0},on:{click:e.batchDeleteFileConfirm}},[e._v(e._s(e.$t("STORAGE.DELETE_FILES")))]),e.showSearch?e._e():n("Button",{attrs:{type:"primary"},on:{click:function(t){e.showSearch=!0}}},[e._v("查找文件")]),n("transition",{attrs:{name:"slide-fade"}},[e.showSearch?n("div",{staticClass:"section-search"},[n("span",{staticClass:"bsc-input"},[n("input",{staticClass:"input-append-before",attrs:{type:"text",disabled:""},domProps:{value:e.prefix}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchValue,expression:"searchValue"}],attrs:{type:"text"},domProps:{value:e.searchValue},on:{focus:function(t){e.searchInputFocus=!0},input:function(t){t.target.composing||(e.searchValue=t.target.value)}}}),n("Button",{attrs:{type:"text",size:"small"},on:{click:function(t){e.searchFile(e.searchValue)}}},[n("Icon",{attrs:{type:"search",size:e.iconSize}})],1)],1)]):e._e()])],1)]),n("Col",{staticStyle:{"text-align":"right"},attrs:{span:"14"}},[n("legend-list",{attrs:{data:e.legendList}})],1)],1),e.spinShow?n("Spin",{attrs:{size:"bigger",fix:""}}):e._e(),n("Modal",{model:{value:e.copyModal,callback:function(t){e.copyModal=t},expression:"copyModal"}},[n("div",{staticStyle:{"text-align":"left"}},[e._v("\n      "+e._s(e.$t("STORAGE.COPY_LINK_CONFIRM",{selectedFileKey:e.selectedFileKey}))+"\n    ")]),n("div",{staticClass:"copy-modal-footer",attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:function(t){e.copyModal=!1}}},[n("span",[e._v(e._s(e.$t("PUBLIC.CANCLE")))])]),n("Button",{directives:[{name:"clip",rawName:"v-clip"}],attrs:{type:"info","data-clipboard-text":e.clipUrl},on:{click:function(t){e.copyAction()}}},[e._v(e._s(e.$t("PUBLIC.COPY")))])],1)]),n("Modal",{attrs:{title:e.$t("STORAGE.ADD_FOLDER")},on:{"on-ok":e.addFolder,"on-cancel":function(t){e.createFolderValue=""}},model:{value:e.createFolderModal,callback:function(t){e.createFolderModal=t},expression:"createFolderModal"}},[n("Input",{attrs:{placeholder:e.$t("STORAGE.FOLDER_PLACEHOLDER")},on:{"on-enter":e.addFolder},model:{value:e.createFolderValue,callback:function(t){e.createFolderValue=t},expression:"createFolderValue"}})],1),n("Modal",{attrs:{title:e.$t("STORAGE.RENAME")},on:{"on-ok":e.rename,"on-cancel":function(t){e.renameKey=""}},model:{value:e.renameModal,callback:function(t){e.renameModal=t},expression:"renameModal"}},[n("Input",{attrs:{placeholder:e.$t("STORAGE.RENAME_PLACEHOLDER")},on:{"on-enter":e.rename},model:{value:e.renameKey,callback:function(t){e.renameKey=t},expression:"renameKey"}})],1),n("Modal",{attrs:{title:e.imageModalTitle,width:"900"},model:{value:e.showImageModal,callback:function(t){e.showImageModal=t},expression:"showImageModal"}},[n("div",{staticClass:"section-img"},[n("img",{attrs:{src:e.clipUrl}})]),n("div",{attrs:{slot:"footer"},slot:"footer"})]),n("Modal",{attrs:{"mask-closable":e.uploadModalMaskClosable,title:e.$t("STORAGE.UPLOAD_FLIE"),width:"700"},on:{"on-cancel":e.uploadModalClose},model:{value:e.uploadModal,callback:function(t){e.uploadModal=t},expression:"uploadModal"}},[n("RadioGroup",{model:{value:e.aclType,callback:function(t){e.aclType=t},expression:"aclType"}},[n("Radio",{attrs:{label:"authenticated-read"}},[e._v(e._s(e.$t("STORAGE.AUTHENTICATED_READ")))]),n("Radio",{attrs:{label:"public-read"}},[e._v(e._s(e.$t("STORAGE.PUBULIC_READ")))])],1),n("upload",{ref:"upload",staticStyle:{"margin-top":"15px"},attrs:{bucket:e.bucket,prefix:e.prefix,"acl-type":e.aclType}}),n("div",{attrs:{slot:"footer"},slot:"footer"})],1),n("Modal",{attrs:{title:e.$t("STORAGE.FILE_PERMISSIONS"),width:"700"},model:{value:e.showPermissonModal,callback:function(t){e.showPermissonModal=t},expression:"showPermissonModal"}},[e.showPermissonModal?n("file-permission",{attrs:{bucket:e.bucket,filePrefix:e.prefix,itemKey:e.permissionKey,"show-modal":e.showPermissonModal},on:{permissionSuccess:function(t){e.showPermissonModal=!1}}}):e._e(),n("div",{staticClass:"copy-modal-footer",attrs:{slot:"footer"},slot:"footer"},[n("Button",{staticStyle:{visibility:"hidden"},attrs:{type:"primary"}},[e._v(e._s(e.$t("STORAGE.SAVE_PERMISSIONS")))])],1)],1),e._m(0),n("Table",{attrs:{"show-header":e.showHeader,stripe:!0,context:e.self,columns:e.fileHeader,data:e.fileList,"no-data-text":e.$t("STORAGE.NO_FILE")},on:{"on-selection-change":e.select}}),n("div",{staticClass:"section-paging"},[n("div",[n("Tag",[e._v(e._s(e.fileList.length)+" files or folders in this page")])],1),n("div",[n("Button",{directives:[{name:"show",rawName:"v-show",value:e.makerArray.length>0,expression:"makerArray.length > 0"}],attrs:{type:"ghost",size:"small"},on:{click:function(t){e.getData("",e.searchValue),e.makerArray.length=0}}},[e._v(e._s(e.$t("PUBLIC.PAGE_FIRST")))]),n("Button",{directives:[{name:"show",rawName:"v-show",value:e.makerArray.length>0,expression:"makerArray.length > 0"}],attrs:{type:"ghost",size:"small"},on:{click:function(t){e.previousPage()}}},[e._v(e._s(e.$t("PUBLIC.PAGE_PREV")))]),n("Button",{directives:[{name:"show",rawName:"v-show",value:e.nextMarker,expression:"nextMarker"}],attrs:{type:"ghost",size:"small"},on:{click:function(t){e.nextPage()}}},[e._v(e._s(e.$t("PUBLIC.PAGE_NEXT")))])],1)]),!0===e.showPicturePreview?n("picture-preview",{attrs:{selectedIndex:e.selectedIndex,fileList:e.fileList,bucket:e.bucket,prefix:e.prefix},on:{close:function(t){e.showPicturePreview=!1}}}):e._e()],1)},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{staticStyle:{display:"none"},attrs:{download:"",id:"element-download"}},[n("span",{attrs:{id:"span-download"}})])}],o=(n("bc72"),n("c154"),n("aba3"),n("25d7"),n("9382"),n("b267")),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bsc-picture-preview"},[n("div",{staticClass:"content"},[n("div",{staticClass:"close-preview",on:{click:e.close}},[n("Icon",{attrs:{type:"close",size:"50"}})],1),n("div",{staticClass:"picture-show-box"},[e.spinShow?n("Spin",{attrs:{size:"bigger",fix:""}}):e._e(),n("img",{staticClass:"box-picture",attrs:{src:e.pictureUrl},on:{load:function(t){e.adaptPage(),e.spinShow=!1}}})],1)]),n("div",{staticClass:"right-gallery-list"},e._l(e.pictureUrlList,function(t,i){return n("p",{key:t,staticClass:"gallery-list-item",on:{click:function(n){e.changePicture(t,i)}}},[n("img",{staticClass:"gallery-list-img",attrs:{src:t}})])})),n("div",{staticClass:"bottom-gallery-details"},[n("div",{staticClass:"details-number"},[e._v(e._s(e.selectedPictureIndex)+" / "+e._s(e.pictureNumber))]),n("div",{staticClass:"details-actions"},[n("Tooltip",{staticClass:"actions-icon",attrs:{content:"放大",placement:"top"}},[n("div",{on:{click:function(t){e.larger()}}},[n("Icon",{attrs:{type:"plus",size:"28"}})],1)]),n("Tooltip",{staticClass:"actions-icon",attrs:{content:"缩小",placement:"top"}},[n("div",{on:{click:function(t){e.smaller()}}},[n("Icon",{attrs:{type:"minus",size:"28"}})],1)]),n("Tooltip",{staticClass:"actions-icon",attrs:{content:"实际大小",placement:"top"}},[n("div",{on:{click:function(t){e.actualSize()}}},[n("Icon",{attrs:{type:"android-contract",size:"28"}})],1)]),n("Tooltip",{staticClass:"actions-icon",attrs:{content:"适应页面",placement:"top"}},[n("div",{on:{click:function(t){e.adaptPage()}}},[n("Icon",{attrs:{type:"android-expand",size:"28"}})],1)]),n("Tooltip",{staticClass:"actions-icon",attrs:{content:"下载原图",placement:"top"}},[n("div",{on:{click:function(t){e.download()}}},[n("Icon",{attrs:{type:"ios-cloud-download",size:"28"}})],1)])],1)]),e._m(0)])},s=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{staticStyle:{display:"none"},attrs:{download:"",id:"element-download"}},[n("span",{attrs:{id:"span-download"}})])}],c=n("ff66"),l=void 0,u={props:["selectedIndex","fileList","bucket","prefix"],data:function(){return{pictureUrlList:[],pictureUrl:this.pictureUrl,pictureNumber:0,selectedPictureIndex:0,width:0,height:0,spinShow:!0}},watch:{width:function(e){e>=5e3?$(".actions-icon:eq(0)").addClass("disable"):$(".actions-icon:eq(0)").removeClass("disable"),e<=120?$(".actions-icon:eq(1)").addClass("disable"):$(".actions-icon:eq(1)").removeClass("disable"),e===this.computeActualSize()?$(".actions-icon:eq(2)").addClass("disable"):$(".actions-icon:eq(2)").removeClass("disable"),e.toFixed()===(this.computeActualSize()>1280?(.7*$(".picture-show-box, .big-picture-show-box").width()).toFixed():this.computeActualSize().toFixed())?$(".actions-icon:eq(3)").addClass("disable"):$(".actions-icon:eq(3)").removeClass("disable"),e<$(".picture-show-box, .big-picture-show-box").width()&&this.height<$(".picture-show-box, .big-picture-show-box").height()?$(".picture-show-box, .big-picture-show-box").addClass("picture-show-box").removeClass("big-picture-show-box"):$(".picture-show-box, .big-picture-show-box").addClass("big-picture-show-box").removeClass("picture-show-box")},height:function(e){this.width<$(".picture-show-box, .big-picture-show-box").width()&&e<$(".picture-show-box, .big-picture-show-box").height()?$(".picture-show-box, .big-picture-show-box").addClass("picture-show-box").removeClass("big-picture-show-box"):$(".picture-show-box, .big-picture-show-box").addClass("big-picture-show-box").removeClass("picture-show-box")}},created:function(){document.addEventListener("keydown",this.EscClose),this.getUrlList()},methods:{getUrlList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=0,this.fileList.forEach(function(e,i){e.isImage&&!0===e.isImage&&(t+=1,i===n.selectedIndex&&(n.selectedPictureIndex=t))}),this.pictureUrlList.length=this.pictureNumber=t,e.next=5,p(this.bucket,this.fileList[this.selectedIndex],this.prefix);case 5:return this.pictureUrl=e.sent,$(".gallery-list-item:eq(".concat(this.selectedPictureIndex-1,")")).addClass("active"),e.next=9,Promise.all(this.fileList.filter(function(e){return e.isImage&&!0===e.isImage}).map(function(e){return p(n.bucket,e,n.prefix)}));case 9:this.pictureUrlList=e.sent;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),changePicture:function(e,t){this.pictureUrl=e,this.selectedPictureIndex=t+1,$(".gallery-list-item").removeClass("active"),$(".gallery-list-item:eq(".concat(t,")")).addClass("active"),this.adaptPage()},computeActualSize:function(){var e=new Image;return e.src=this.pictureUrl,e.width},EscClose:function(e){27===e.keyCode&&this.close()},close:function(){this.$emit("close")},larger:function(){var e=$(".box-picture").width();$(".box-picture").width(this.width=e>=5e3?e:1.25*e),this.height=$(".box-picture").height()},smaller:function(){var e=$(".box-picture").width();$(".box-picture").width(this.width=e<=120?e:.8*e),this.height=$(".box-picture").height()},actualSize:function(){$(".box-picture").width(this.width=this.computeActualSize()),this.height=$(".box-picture").height()},adaptPage:function(){var e=this.computeActualSize();$(".box-picture").width(e>1280?"70%":e),this.width=$(".box-picture").width(),this.height=$(".box-picture").height()},download:function(){document.querySelector("#element-download").href=this.pictureUrl,document.querySelector("#span-download").click()}}},p=function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,n,i){var r,o,a,s,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r={Bucket:t,Key:i+n.Key},e.next=4,Object(c["c"])();case 4:return o=e.sent,e.next=7,o.getSignedUrl("getObject",r);case 7:return a=e.sent,e.next=10,Object(c["d"])("getObjectAcl",r);case 10:return s=e.sent,u=_.find(s.Grants,function(e){return e.Grantee.URI&&"http://acs.amazonaws.com/groups/global/AllUsers"===e.Grantee.URI}),e.abrupt("return",u?a.split("?")[0]:a);case 15:return e.prev=15,e.t0=e["catch"](0),l.$Loading.error(),e.abrupt("return",Promise.reject(e.t0));case 19:case"end":return e.stop()}},e,this,[[0,15]])}));return function(t,n,i){return e.apply(this,arguments)}}(),d=u,h=(n("408e"),n("048f")),f=Object(h["a"])(d,a,s,!1,null,"f3b97b5e",null);f.options.__file="picturePreview.vue";var m=f.exports,b=n("7265"),y=n("acc6"),v=n("36fa"),g=n("b047"),x=n.n(g),w=n("4360"),k=n("7340"),E=n("e9b81"),S=n("23d5"),O=n.n(S),C=n("05dc"),T=void 0,L={components:{filePermission:C["default"],bscBreadcrumb:y["a"],bscBreadcrumbItem:y["a"].Item,upload:v["a"],legendList:E["a"],picturePreview:m},directives:{clip:{bind:function(e){new x.a(e)}}},data:function(){var e=this;return{clipUrl:"",showPicturePreview:!1,selectedIndex:0,searchValue:"",copyModal:!1,nextMarker:"",makerArray:[],showImageModal:!1,showPermissonModal:!1,createFolderModal:!1,renameModal:!1,searchMode:!1,uploadModal:!1,aclType:"authenticated-read",uploadModalMaskClosable:!1,createFolderValue:"",selectedFileKey:"",showSearch:!1,renameKey:"",selectedFileList:[],legendList:[{icon:"compose",text:"STORAGE.RENAME"},{icon:"gear-a",text:"STORAGE.FILE_PERMISSIONS"},{icon:"ios-cloud-download",text:"SETTINGS.DOWNLOAD"},{icon:"eye",text:"STORAGE.IMG_PREVIEW"},{icon:"link",text:"PUBLIC.COPY"},{icon:"ios-trash",text:"PUBLIC.DELETE"}],inputCheck:!1,fileList:[],self:this,showHeader:!0,iconSize:18,spinShow:!0,fileHeader:[{type:"selection",width:"58px",align:"center"},{title:"Key",key:"Key",ellipsis:!0,sortable:!0,render:function(t,n){return t("div",{on:{click:function(){"file"!==n.row.Type&&e.openFolder(n.row)}},style:{cursor:"file"===n.row.Type?"default":"pointer"}},[t("Icon",{props:{type:"file"===n.row.Type?"document":"folder",size:16},style:{position:"relative",top:"1px",paddingRight:"4px"}}),t("strong",{class:{"link-folder":"file"!==n.row.Type}},n.row.Key)])}},{title:"Size",width:"15%",align:"right",key:"convertSize"},{title:"Create time",key:"LastModified",align:"right",width:"25%",sortable:!0},{title:"Actions",key:"actions",width:"25%",align:"right",render:function(t,n){return"folder"===n.row.Type?t("Tooltip",{props:{content:e.$t("STORAGE.DELETE_FOLDER"),delay:1e3,placement:"top-end"},class:{"mar-r-5":!0}},[t("i-button",{props:{size:"small"},on:{click:function(){e.deleteFileConfirm(n.row)}}},[t("Icon",{props:{type:"ios-trash",size:e.iconSize}})])]):t("div",[t("Tooltip",{props:{content:e.$t("STORAGE.RENAME"),delay:1e3,placement:"top"},class:{"mar-r-5":!0}},[t("i-button",{props:{size:"small"},on:{click:function(){e.selectedFileKey=n.row.Key,e.renameKey=n.row.Key,e.renameModal=!0}}},[t("Icon",{props:{type:"compose",size:e.iconSize}})])]),t("Tooltip",{props:{content:e.$t("STORAGE.FILE_PERMISSIONS"),delay:1e3,placement:"top"},class:{"mar-r-5":!0}},[t("i-button",{props:{size:"small"},on:{click:function(){e.permissionModal(n.row)}}},[t("Icon",{props:{type:"gear-a",size:e.iconSize}})])]),t("Tooltip",{props:{content:e.$t("STORAGE.DOWNLOAD_FILE"),delay:1e3,placement:"top"},class:{"mar-r-5":!0}},[t("i-button",{props:{size:"small"},on:{click:function(){e.downloadFile(n.row)}}},[t("Icon",{props:{type:"ios-cloud-download",size:e.iconSize}})])]),t("Tooltip",{props:{content:e.$t("STORAGE.IMG_PREVIEW"),delay:1e3,placement:"top"},class:{"mar-r-5":!0}},[t("i-button",{props:{disabled:n.row&&!n.row.isImage,size:"small"},on:{click:function(){e.showPicturePreview=!0,e.selectedIndex=n.row._index}}},[t("Icon",{props:{type:"eye",size:e.iconSize}})])]),t("Tooltip",{props:{content:e.$t("STORAGE.COPY_FILE_LINK"),delay:1e3,placement:"top"},class:{"mar-r-5":!0}},[t("i-button",{props:{size:"small"},on:{click:function(){e.clipModal(n.row)}}},[t("Icon",{props:{type:"link",size:e.iconSize}})])]),t("Tooltip",{props:{content:e.$t("STORAGE.DELETE_FILE"),delay:1e3,placement:"top"}},[t("i-button",{props:{size:"small"},on:{click:function(){e.deleteFileConfirm(n.row)}}},[t("Icon",{props:{type:"ios-trash",size:e.iconSize}})])])])}}],permissionKey:"",searchInputFocus:!1,canUpload:!1}},computed:{bucket:function(){return this.$route.params.bucket},prefix:function(){return"noprefix"===this.$route.params.prefix?"":this.$route.params.prefix},breadcrumb:function(){return Object(b["f"])(this.prefix)},bucketPath:function(){return"/bucket/".concat(this.$route.params.bucket)},imageModalTitle:function(){return this.selectedFileKey||this.$t("STORAGE.NO_TITLE")}},watch:{$route:function(e,t){e.path!==t.path&&this.getData()}},created:function(){this.getData(),this.checkCanUpload()},methods:{getData:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,i,r,o=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",this.$Loading.start(),this.spinShow=!0,e.prev=3,i=this,e.next=7,Object(c["d"])("listObjects",{Bucket:this.bucket,Delimiter:"/",MaxKeys:100,Marker:t||this.prefix,Prefix:this.prefix+n});case 7:return r=e.sent,this.nextMarker=r.NextMarker,e.next=11,_.forEach(r.CommonPrefixes,function(e){e.Key=Object(b["j"])(e.Prefix,i.prefix),e.Type="folder",e.LastModified="",e.convertSize=""}).concat(_.forEach(r.Contents,function(e){e.Key=Object(b["j"])(e.Key,i.prefix),e.convertSize=Object(b["d"])(e.Size),e.Type="file",e.isImage=A(e),e.LastModified=O()(e.LastModified).format("YYYY-MM-DD HH:mm")}));case 11:this.fileList=e.sent,document.querySelector("#app").scrollTop=0,this.spinShow=!1,this.$Loading.finish(),e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](3),this.spinShow=!1,this.$Loading.error();case 21:case"end":return e.stop()}},e,this,[[3,17]])}));return function(t){return e.apply(this,arguments)}}(),rename:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.renameModal=!1,!(this.renameKey.length>0)){e.next=19;break}if(this.selectedFileKey!==this.renameKey){e.next=4;break}return e.abrupt("return",!1);case 4:return e.prev=4,this.$Loading.start(),e.next=8,Object(c["d"])("copyObject",{Bucket:this.bucket,CopySource:encodeURIComponent(this.bucket+"/"+this.prefix+this.selectedFileKey),Key:this.prefix+this.renameKey});case 8:return e.next=10,Object(c["d"])("deleteObject",{Bucket:this.bucket,Key:this.prefix+this.selectedFileKey});case 10:this.renameKey="",this.getData(),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](4),this.$Loading.error();case 17:e.next=20;break;case 19:this.$Message.error(this.$t("STORAGE.RENAME_PLACEHOLDER"));case 20:case"end":return e.stop()}},e,this,[[4,14]])}));return function(){return e.apply(this,arguments)}}(),back:function(){this.$router.back()},previousPage:function(){var e=this.makerArray[this.makerArray.length-2];this.makerArray.pop(),this.getData(e,this.searchValue)},nextPage:function(){this.nextMarker&&this.makerArray.push(this.nextMarker),this.getData(this.nextMarker,this.searchValue)},searchFile:function(e){this.searchMode=!0,this.getData(this.prefix,e)},addFolder:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.createFolderValue){e.next=2;break}return e.abrupt("return");case 2:return this.createFolderModal=!1,e.prev=3,e.next=6,Object(c["d"])("putObject",{Bucket:this.bucket,Key:this.prefix+this.createFolderValue+"/",Body:""});case 6:this.$Message.success(this.$t("STORAGE.ADD_FOLDER_SUCCESS")),this.getData(),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),this.$Message.error(this.$t("STORAGE.ADD_FOLDER_FAILED"));case 13:case"end":return e.stop()}},e,this,[[3,10]])}));return function(){return e.apply(this,arguments)}}(),clipModal:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$Loading.start(),e.next=3,I(this.bucket,t,this.prefix);case 3:this.clipUrl=e.sent,this.selectedFileKey=t.Key,this.copyModal=!0,this.$Loading.finish();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),openUploadModal:function(){this.uploadModal=!0},download:function(e){document.querySelector("#element-download").href=e,document.querySelector("#span-download").click()},downloadFile:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this,"file"!==t.Type){e.next=8;break}return e.next=4,I(this.bucket,t,this.prefix,!0);case 4:i=e.sent,this.download(i),e.next=12;break;case 8:return e.next=10,Object(c["d"])("listObjects",{Bucket:this.bucket,Prefix:this.prefix+t.Prefix,Delimiter:"/",Marker:this.prefix+t.Prefix});case 10:r=e.sent,_.each(r.Contents,function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,I(n.bucket,t,n.prefix);case 2:i=e.sent,n.download(i);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),imageModal:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$Loading.start(),e.next=3,I(this.bucket,t,this.prefix);case 3:this.clipUrl=e.sent,this.selectedFileKey=t.Key,this.showImageModal=!0,this.$Loading.finish();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),permissionModal:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.permissionKey=t.Key,this.showPermissonModal=!0;case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),batchDeleteFileConfirm:function(){var e=this;this.$Modal.confirm({content:this.$t("STORAGE.DELETE_FILES_CONFIRMED"),okText:this.$t("PUBLIC.CONFIRMED"),cancelText:this.$t("PUBLIC.CANCLE"),title:this.$t("PUBLIC.DELETE"),onOk:function(){return e.batchDelete()}})},deleteFileConfirm:function(e){var t=this;this.$Modal.confirm({content:this.$t("STORAGE.DELETE_CONFIRMED",{fileName:e.Key}),okText:this.$t("PUBLIC.CONFIRMED"),cancelText:this.$t("PUBLIC.CANCLE"),title:this.$t("PUBLIC.DELETE"),onOk:function(){return t.deleteFile(e)}})},deleteFile:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,"file"!==t.Type){e.next=6;break}return e.next=4,Object(c["d"])("deleteObject",{Bucket:this.bucket,Key:this.prefix+t.Key});case 4:e.next=7;break;case 6:this.deleteFolders(t);case 7:this.getData(),this.$Message.success(this.$t("STORAGE.DELETE_FILES_SUCCESS",{fileName:t.Key})),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),this.spinShow=!1,this.$Message.error(this.$t("STORAGE.DELETE_FILES_FAILED",{fileName:t.Key}));case 15:case"end":return e.stop()}},e,this,[[0,11]])}));return function(t){return e.apply(this,arguments)}}(),deleteFolders:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,i,r=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"",this.spinShow=!0,e.prev=2,e.next=5,Object(c["d"])("listObjects",{Bucket:this.bucket,Prefix:t.Prefix,MaxKeys:1e3,Marker:n});case 5:return i=e.sent,e.next=8,Object(c["d"])("deleteObjects",{Bucket:this.bucket,Delete:{Objects:i.Contents.map(function(e){return _.pick(e,"Key")})}});case 8:if(1e3!==i.Contents.length){e.next=12;break}this.deleteFolders(t,i.Contents[100].Key),e.next=15;break;case 12:return e.next=14,Object(c["d"])("deleteObject",{Bucket:this.bucket,Key:this.prefix+t.Key});case 14:this.spinShow=!1;case 15:e.next=22;break;case 17:e.prev=17,e.t0=e["catch"](2),this.spinShow=!1,this.$Loading.error(),this.$Message.error("Delete the folder [".concat(t.Key,"] error"));case 22:case"end":return e.stop()}},e,this,[[2,17]])}));return function(t){return e.apply(this,arguments)}}(),batchDelete:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,Promise.all(t.selectedFileList.map(function(e){return t.deleteFile(e)}));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),batchDownload:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,Promise.all(t.selectedFileList.map(function(e){return t.downloadFile(e)}));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),openFolder:function(e){this.searchValue="",this.$router.push({name:"file",params:{bucket:this.bucket,prefix:e.Prefix}})},getUrl:function(e){return"/bucket/"+this.bucket+"/prefix/"+R(e,"/","%2F")},uploadModalClose:function(){this.getData(),this.$refs.upload.clearFiles()},checkCanUpload:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!Object(k["a"])("SUBUSER")){e.next=7;break}return e.next=3,Object(c["d"])("getBucketAcl",{Bucket:this.bucket});case 3:t=e.sent,_.each(t.Grants,function(e){e.Grantee.ID!==w["a"].state.current.username||"FULL_CONTROL"!==e.Permission&&"WRITE"!==e.Permission||(n.canUpload=!0)}),e.next=8;break;case 7:this.canUpload=!0;case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),select:function(e){this.selectedFileList=e},setLoading:function(e){this.$store.dispatch("setLoading",e)},copyAction:function(){this.copyModal=!1,this.$Message.success($t("STORAGE.COPIED"))}}},R=function(e,t,n){var i=e;while(i.indexOf(t)>0)i=i.replace(t,n);return i},A=function(e){return!!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(e.Key)},I=function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,n,i){var r,o,a,s,l,u,p,d=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=d.length>3&&void 0!==d[3]&&d[3],e.prev=1,o=r?{Bucket:t,Key:i+n.Key,ResponseContentDisposition:"attachment"}:{Bucket:t,Key:i+n.Key},a={Bucket:t,Key:i+n.Key},e.next=6,Object(c["c"])();case 6:return s=e.sent,e.next=9,s.getSignedUrl("getObject",o);case 9:return l=e.sent,e.next=12,Object(c["d"])("getObjectAcl",a);case 12:return u=e.sent,p=_.find(u.Grants,function(e){return e.Grantee.URI&&"http://acs.amazonaws.com/groups/global/AllUsers"===e.Grantee.URI}),e.abrupt("return",r?l:p?l.split("?")[0]:l);case 17:return e.prev=17,e.t0=e["catch"](1),T.$Loading.error(),e.abrupt("return",Promise.reject(e.t0));case 21:case"end":return e.stop()}},e,this,[[1,17]])}));return function(t,n,i){return e.apply(this,arguments)}}(),M=L,P=(n("0c54"),Object(h["a"])(M,i,r,!1,null,"b2631fba",null));P.options.__file="File.vue";t["default"]=P.exports},"408e":function(e,t,n){"use strict";var i=n("532e"),r=n.n(i);r.a},"532e":function(e,t,n){},6288:function(e,t,n){},"74f19":function(e,t){var n=9;if("undefined"!==typeof Element&&!Element.prototype.matches){var i=Element.prototype;i.matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector}function r(e,t){while(e&&e.nodeType!==n){if("function"===typeof e.matches&&e.matches(t))return e;e=e.parentNode}}e.exports=r},"91da":function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"===typeof e||e instanceof String},t.fn=function(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t}},"9ca1":function(e,t,n){var i=n("91da"),r=n("c90e");function o(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!i.string(t))throw new TypeError("Second argument must be a String");if(!i.fn(n))throw new TypeError("Third argument must be a Function");if(i.node(e))return a(e,t,n);if(i.nodeList(e))return s(e,t,n);if(i.string(e))return c(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function a(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}function s(e,t,n){return Array.prototype.forEach.call(e,function(e){e.addEventListener(t,n)}),{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,n)})}}}function c(e,t,n){return r(document.body,e,t,n)}e.exports=o},a046:function(e,t,n){"use strict";var i=n("1aa1b"),r=n.n(i);r.a},b047:function(e,t,n){var i,r,o;(function(a,s){r=[e,n("ede5"),n("e05c"),n("9ca1")],i=s,o="function"===typeof i?i.apply(t,r):i,void 0===o||(e.exports=o)})(0,function(e,t,n,i){"use strict";var r=s(t),o=s(n),a=s(i);function s(e){return e&&e.__esModule?e:{default:e}}var c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=function(e){function t(e,n){l(this,t);var i=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.resolveOptions(n),i.listenClick(e),i}return d(t,e),u(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"===typeof e.action?e.action:this.defaultAction,this.target="function"===typeof e.target?e.target:this.defaultTarget,this.text="function"===typeof e.text?e.text:this.defaultText,this.container="object"===c(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,a.default)(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new r.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return f("action",e)}},{key:"defaultTarget",value:function(e){var t=f("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return f("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"===typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach(function(e){n=n&&!!document.queryCommandSupported(e)}),n}}]),t}(o.default);function f(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}e.exports=h})},c90e:function(e,t,n){var i=n("74f19");function r(e,t,n,i,r){var o=a.apply(this,arguments);return e.addEventListener(n,o,r),{destroy:function(){e.removeEventListener(n,o,r)}}}function o(e,t,n,i,o){return"function"===typeof e.addEventListener?r.apply(null,arguments):"function"===typeof n?r.bind(null,document).apply(null,arguments):("string"===typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return r(e,t,n,i,o)}))}function a(e,t,n,r){return function(n){n.delegateTarget=i(n.target,t),n.delegateTarget&&r.call(e,n)}}e.exports=o},d85a:function(e,t){function n(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var i=window.getSelection(),r=document.createRange();r.selectNodeContents(e),i.removeAllRanges(),i.addRange(r),t=i.toString()}return t}e.exports=n},e05c:function(e,t){function n(){}n.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var i=this;function r(){i.off(e,r),t.apply(n,arguments)}return r._=t,this.on(e,r,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,r=n.length;for(i;i<r;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],r=[];if(i&&t)for(var o=0,a=i.length;o<a;o++)i[o].fn!==t&&i[o].fn._!==t&&r.push(i[o]);return r.length?n[e]=r:delete n[e],this}},e.exports=n},e9b81:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bsc-legend"},e._l(e.data,function(t){return n("div",{key:t.text,staticClass:"legend-item"},[n("Icon",{attrs:{type:t.icon,size:"14"}}),n("span",{staticClass:"legend-text"},[e._v(e._s(e.$t(t.text)))]),t!==e.data[e.data.length-1]?n("span",{staticClass:"legend-separator"},[e._v("|")]):e._e()],1)}))},r=[],o={props:["data"]},a=o,s=(n("a046"),n("048f")),c=Object(s["a"])(a,i,r,!1,null,"ea96999c",null);c.options.__file="legend.vue";t["a"]=c.exports},ede5:function(e,t,n){var i,r,o;(function(a,s){r=[e,n("d85a")],i=s,o="function"===typeof i?i.apply(t,r):i,void 0===o||(e.exports=o)})(0,function(e,t){"use strict";var n=i(t);function i(e){return e&&e.__esModule?e:{default:e}}var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){o(this,e),this.resolveOptions(t),this.initSelection()}return a(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=i+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,n.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,n.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==("undefined"===typeof e?"undefined":r(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=s})}}]);